@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>OrgChart</title>
    <script src="~/Scripts/OrgChart.js"></script>
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Scripts/jsMyOwnTools.js"></script>
    <style>
        html, body {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
            overflow: hidden;
        }

        #tree {
            width: 100%;
            height: 100%;
        }

        .field_0 {
            font-family: Impact;
        }
    </style>
</head>
<body>

    <div id="editForm" style="display:none; text-align:center; position:absolute; border: 1px solid #aeaeae;width:400px;background-color:#F57C00;z-index:10000; ">
        <div style="padding: 10px 0 10px 0; background-color:#039BE5; color: #ffffff;"><strong>Datos Usuario</strong></div>
        <div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Tipo Elemento:</label>
                <select id="cmbTipoElemento" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label id="labelElemento" style="color:#ffffff; width:150px; display:inline-block;" for="labelElemento">Cargo:</label>
                <input style="background-color:#FFCA28" width="200" id="elemento" value="" />
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Origen Usuario:</label>
                <select id="cmbDirectorio" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Login:</label>
                <select id="cmbUsers" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Nombre:</label>
                <input style="background-color:#FFCA28" width="200" id="name" value="" />
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="email">Email:</label>
                <input style="background-color:#FFCA28" width="200" id="email" value="" />
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="dependencia">Dependencia:</label>
                <select id="cmbDependencia" class="form-control" width=180px></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="tipoidentificacion">Tipo Identificación:</label>
                <select id="cmbTipoIdentificacion" class="form-control" width=180px></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="identificacion">Número Identificación:</label>
                <input style="background-color:#FFCA28" width="200" id="numIdentificacion" value="" />
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="bloqueo">Bloqueado:</label>
                <label style="color:#ffffff; width:20px; display:inline-block;" for="Si">Sí</label><input type="radio" id="BloqSi" name="bloqueado" value="1">
                <label style="color:#ffffff; width:20px; display:inline-block;" for="Si">No</label><input type="radio" id="BloqNo" name="bloqueado" value="0">

            </div>

            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="activo">Activo:</label>
                <input type="checkbox" id="chbxActivo" name="activo" value="1">
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="activo">Rol Principal:</label>
                <input type="checkbox" id="chbxRolPrincipal" name="activo" value="1">
            </div>

            <div style="padding: 5px 0 15px 0;">
                <button style="width:108px;" id="cancel">Cancelar</button>
                <button style="width:108px;" id="save">Guardar</button>
            </div>
        </div>
    </div>

    <div id="deleteForm" style="display:none; text-align:center; position:absolute; border: 1px solid #aeaeae;width:400px;background-color:#F57C00;z-index:10000; ">
        <div style="padding: 10px 0 10px 0; background-color:#039BE5; color: #ffffff;"><strong>Datos Usuario</strong></div>
        <div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Tipo Elemento:</label>
                <select id="cmbTipoElementoDel" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label id="labelElementoDel" style="color:#ffffff; width:150px; display:inline-block;" for="labelElementoDel">Cargo:</label>
                <input style="background-color:#FFCA28" width="200" id="elementoDel" value="" />
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Origen Usuario:</label>
                <select id="cmbDirectorioDel" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Login:</label>
                <select id="cmbUsersDel" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Nombre:</label>
                <input style="background-color:#FFCA28" width="200" id="nameDel" value="" />
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="email">Email:</label>
                <input style="background-color:#FFCA28" width="200" id="emailDel" value="" />
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="dependencia">Dependencia:</label>
                <select id="cmbDependenciaDel" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="tipoidentificacion">Tipo Identificación:</label>
                <select id="cmbTipoIdentificacionDel" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="identificacion">Número Identificación:</label>
                <input style="background-color:#FFCA28" width="200" id="numIdentificacionDel" value="" />
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="bloqueo">Bloqueado:</label>
                <label style="color:#ffffff; width:20px; display:inline-block;" for="Si">Sí</label><input type="radio" id="BloqSiDel" name="bloqueadoDel" value="1">
                <label style="color:#ffffff; width:20px; display:inline-block;" for="Si">No</label><input type="radio" id="BloqNoDel" name="bloqueadoDel" value="0">

            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="activo">Activo:</label>
                <input type="checkbox" id="chbxActivoDel" name="activo" value="1">
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="activo">Rol Principal:</label>
                <input type="checkbox" id="chbxRolPrincipalDel" name="activo" value="1">
            </div>

            <div style="padding: 5px 0 15px 0;">
                <button style="width:108px;" id="yes">Sí</button>
                <button style="width:108px;" id="no">No</button>
            </div>
        </div>
    </div>


    <div id="detailForm" style="display:none; text-align:center; position:absolute; border: 1px solid #aeaeae;width:400px;background-color:#F57C00;z-index:10000; ">
        <div style="padding: 10px 0 10px 0; background-color:#039BE5; color: #ffffff;"><strong>Datos Usuario</strong></div>
        <div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Tipo Elemento:</label>
                <select id="cmbTipoElementoDet" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label id="labelElementoDet" style="color:#ffffff; width:150px; display:inline-block;" for="labelElementoDet">Cargo:</label>
                <input style="background-color:#FFCA28" width="200" id="elementoDet" value="" />
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Origen Usuario:</label>
                <select id="cmbDirectorioDet" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Login:</label>
                <select id="cmbUsersDet" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="name">Nombre:</label>
                <input style="background-color:#FFCA28" width="200" id="nameDet" value="" />
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="email">Email:</label>
                <input style="background-color:#FFCA28" width="200" id="emailDet" value="" />
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="dependencia">Dependencia:</label>
                <select id="cmbDependenciaDet" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="tipoidentificacion">Tipo Identificación:</label>
                <select id="cmbTipoIdentificacionDet" class="form-control" width="200"></select>
            </div>
            <div style="padding: 10px 0 5px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="identificacion">Número Identificación:</label>
                <input style="background-color:#FFCA28" width="200" id="numIdentificacionDet" value="" />
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="bloqueo">Bloqueado:</label>
                <label style="color:#ffffff; width:20px; display:inline-block;" for="Si">Sí</label><input type="radio" id="BloqSiDet" name="bloqueadoDet" value="1">
                <label style="color:#ffffff; width:20px; display:inline-block;" for="Si">No</label><input type="radio" id="BloqNoDet" name="bloqueadoDet" value="0">

            </div>

            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="activo">Activo:</label>
                <input type="checkbox" id="chbxActivoDet" name="activo" value="1">
            </div>
            <div style="padding: 5px 0 10px 40px; text-align:left; ">
                <label style="color:#ffffff; width:150px; display:inline-block;" for="activo">Rol Principal:</label>
                <input type="checkbox" id="chbxRolPrincipalDet" name="activo" value="1">
            </div>

            <div style="padding: 5px 0 15px 0;">
                <button style="width:108px;" id="close">Cerrar</button>
            </div>
        </div>
    </div>

    <div id="tree"></div>

    <script>

        var chart;
         $.get("@Url.Action("Read")").done(function (response) {
            chart = new OrgChart(document.getElementById("tree"), {
                nodeMenu: {
                    details: { text: "Detalles" },
                    edit: { text: "Editar" },
                    addInGroup: { text: "Agregar Grupo" },
                    add: { text: "Agregar Usuario" },
                    remove: { text: "Eliminar" }
                },
                detailUI: new detailForm(),
                nodeBinding: {
                    field_idTE: "pk_TipoElemento",
                    field_1: "elemento",
                    field_idDir: "pk_Directorio",
                    field_idUser: "pk_Usuario",
                    field_login: "loginUsuario",
                    field_email: "emailUsuario",
                    field_0: "nombreUsuario",
                    field_idD: "pk_Dependencia",
                    field_idTI: "pk_TipoIdentificacion",
                    field_NI: "numIdentificacion",
                    field_b: "bloqueado",
                    field_a: "activo",
                    field_rp: "rolPrincipal",
                    field_pid: "pid"
                },

                editUI: new editForm(),
                nodeBinding: {
                    field_idTE: "pk_TipoElemento",
                    field_1: "elemento",
                    field_idDir: "pk_Directorio",
                    field_idUser: "pk_Usuario",
                    field_login: "loginUsuario",
                    field_email: "emailUsuario",
                    field_0: "nombreUsuario",
                    field_idD: "pk_Dependencia",
                    field_idTI: "pk_TipoIdentificacion",
                    field_NI: "numIdentificacion",
                    field_b: "bloqueado",
                    field_a: "activo",
                    field_rp: "rolPrincipal",
                    field_pid: "pid"
                },
                removeUI: new deleteForm(),
                nodeBinding: {
                    field_idTE: "pk_TipoElemento",
                    field_1: "elemento",
                    field_idDir: "pk_Directorio",
                    field_idUser: "pk_Usuario",
                    field_login: "loginUsuario",
                    field_email: "emailUsuario",
                    field_0: "nombreUsuario",
                    field_idD: "pk_Dependencia",
                    field_idTI: "pk_TipoIdentificacion",
                    field_NI: "numIdentificacion",
                    field_b: "bloqueado",
                    field_a: "activo",
                    field_rp: "rolPrincipal",
                    field_pid: "pid"
                },
                nodes: response.nodes
            });
        });

        function guardarNodo(node)
        {
            if (isNaN(node.id)) {
                node.id = 0;
                node.pid = parseInt(node.pid);
            }
             $.post("@Url.Action("UpdateNode")", node)
                .done(function () {
                })
            return false;
        }

       function borrarNodo(idnode) {
           $.post("@Url.Action("RemoveNode")", idnode)
                .done(function () {
                })
            return false;
        }

        init();

    </script>
</body>
</html>

